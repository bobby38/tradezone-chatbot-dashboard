# LiveKit Self-Hosted Deployment for livekit.rezult.co
# Uses host network for direct UDP access (required for WebRTC)

version: '3.8'

services:
  livekit:
    image: livekit/livekit-server:latest
    container_name: livekit-server
    restart: unless-stopped
    network_mode: host
    environment:
      LIVEKIT_CONFIG: |
        port: 7880
        rtc:
          port_range_start: 50000
          port_range_end: 50100
          tcp_port: 7881
          use_external_ip: true
        keys:
          API3da17ac5856eb78524a98386: xN0/L4XcGm2REUgPISgj4rXXxt7JZNAqSKEnC3fRi4I=
        logging:
          level: info
    healthcheck:
      test: ["CMD", "wget", "-q", "--spider", "http://localhost:7880"]
      interval: 30s
      timeout: 10s
      retries: 3

# Note: Using host network mode exposes ports directly on the host
# Ports: 7880 (HTTP), 7881 (TCP), 50000-50100 (UDP)
# Coolify proxy handles SSL for livekit.rezult.co -> localhost:7880
