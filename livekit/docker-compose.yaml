# LiveKit Self-Hosted Deployment for livekit.rezult.co
# Optimized for Coolify deployment (uses Coolify's built-in proxy)

version: '3.8'

services:
  livekit:
    image: livekit/livekit-server:latest
    container_name: livekit-server
    restart: unless-stopped
    ports:
      - "7880:7880"           # HTTP/WebSocket signaling
      - "7881:7881"           # TCP fallback
      - "7881:7881/udp"       # WebRTC UDP
      - "50000-50100:50000-50100/udp"  # RTC port range (reduced for Coolify)
    volumes:
      - ./livekit.yaml:/etc/livekit.yaml:ro
    command: --config /etc/livekit.yaml
    environment:
      - LIVEKIT_KEYS=${LIVEKIT_API_KEY}:${LIVEKIT_API_SECRET}
    healthcheck:
      test: ["CMD", "wget", "-q", "--spider", "http://localhost:7880"]
      interval: 30s
      timeout: 10s
      retries: 3

# Note: Coolify handles SSL/proxy - no need for Caddy service
# Domain livekit.rezult.co should be configured in Coolify to proxy to port 7880
